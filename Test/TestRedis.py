import redis
import logging
import json

if __name__ == "__main__":
    logging_format = '"%(asctime)s %(levelname)s %(module)s %(lineno)d \t%(message)s'
    logging.basicConfig(level=20, format=logging_format)
    logger = logging.getLogger(__name__)

    logger.info("start")
    r = redis.StrictRedis(host='10.164.120.164', port=6379, db=0)
    # r.set('loan_listing_ids', list(range(100)))

    logger.info("start")
    # r.delete("loan_listing_ids")
    redis_loan_listings_str = r.get('list')
    logging.info(redis_loan_listings_str)
    if redis_loan_listings_str is None or redis_loan_listings_str == b"None":
        logger.info("None")
    else:
        logger.info(f"{redis_loan_listings_str}, {json.loads(redis_loan_listings_str)}")
        # r.set("list", json.loads("[123555100,123556802,123557452,123557588,123557971,123558262,123558487,123559827,123560120,123561562,123562298,123563121,123564009,123564206,123564347,123564393,123565029,123565181,123565391,123565948,123566340,123566405,123566707,123567260,123567508,123567544,123567545,123567726,123567981,123567983,123485610,123526688,123537500,123537506,123539301,123539323,123541010,123542750,123543668,123544249,123544592,123545130,123545745,123545811,123546305,123546604,123546925,123548497,123548552,123548784,123548952,123549983,123550615,123550802,123551533,123551707,123551719,123551975,123552840,123554396,123485610,123526688,123537500,123537506,123539301,123539323,123541010,123542750,123543668,123544249,123544592,123545130,123545745,123545811,123546305,123546604,123546925,123548497,123548552,123548784,123548952,123549983,123550615,123550802,123551533,123551707,123551719,123551975,123552840,123554396]"))

    logger.info("end")